---
title: "STAT 184 Final Project"
author: "Zinuo Jia, Alexander Kim"
date: "12/17/2019"
output: html_notebook
---


### Front Matter

```{r}
# clean up the RStudio environment 
rm(list = ls())
# load all packages needed
library(mosaic)
library(DataComputing)
library(tidyverse)
library(lubridate)
library(leaflet)
library(rvest)
library(readr)
```

Importing Data
```{r}
#Source data "vgsales.csv" downloaded from "Kaggle.com/dataset"
#vgsales.csv already uploaded in the repo
vgsales <- read_csv("vgsales.csv")
#load source data "vgconsole" from "https://en.wikipedia.org/wiki/List_of_best-selling_game_consoles" 
page <- "https://en.wikipedia.org/wiki/List_of_best-selling_game_consoles" 
tableList <- page %>%
  read_html() %>%
  html_nodes(css = "table") %>%
  html_table(fill = TRUE)
vgconsole<-tableList[[1]]
vgconsole$Ref. <- NULL #took out the Ref. column that has no value
head(vgconsole)
head(vgsales)
```

### Introduction 
By importing the data source, we introduce our research question:" What are the factors that can influence global sales for video games?"
We can observe our primary data source by using the function `str`  
```{r}
str(vgsales)
```
In this project, we will only analyze the Global sales of each video game.  
```{r}
vgsales1 <- 
  vgsales%>%
  select(Rank,Name,Platform,Year,Genre,Publisher,Global_Sales)
```

##### Platforms & Publisher  
Firstly, we can see whether games in different platforms can affect its global sale. In order to do this, we can check the mean global sales for games in different platform.
```{r}
vgsales1 %>%
  group_by(Platform)%>%
  summarise(MeanSale = mean(Global_Sales))%>%
  arrange(desc(MeanSale))
```
We cannot see how different platforms and publishers can affect the sales by just calculate there means. What if we combine the sales of the platform consoles using our secondary data source. To do this, we can combine our two data source by a joining function, but note that, in our secondary data source, We use full name of platform which is different from our primary data. 
```{r}
str(vgconsole)
```
We can combine two data source by creating a data frame that matches platform names.  
```{r}
#Create a list of full platform names
PlatformFull <-
  vgconsole%>%
  select(Platform)
PlatformFull
```
```{r}
#Create a list of short platform names
PlatformAbb <-
  vgsales%>%
  group_by(Platform)%>%
  summarise(count = n())%>%
  select(Platform)
PlatformAbb
```

```{r}
Platform <- data.frame()
```

Seeing which platform had the greatest sale and within each platform what was the greatest sold game 
```{r}
vgsales %>%
  group_by(Platform) %>%
  filter(rank(desc(Global_Sales))==1)%>%
  ggplot(aes(x=reorder(Platform,-Global_Sales),y=Global_Sales ))+
  geom_bar(stat='identity',position='stack', width=.9)+
  theme(axis.text.x=element_text(angle=60,hjust=1)) 
```


Most Sold Game
```{r}
  vgsales %>%
  group_by(Platform) %>%
  filter(rank(desc(Global_Sales))==1)%>%
  ggplot(aes(x=reorder(Name,-Global_Sales),y=Global_Sales ))+
  geom_bar(stat='identity',position='stack', width=.9) +
  theme(axis.text.x=element_text(angle=60,hjust=1)) +
  xlab("Game Title") +
  ylab("Global Sales")
```

